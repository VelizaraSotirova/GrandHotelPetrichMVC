@model GrandHotelPetrichMVC.ViewModels.Guests.Booking.BookingInputModel
@{
    ViewData["Title"] = "Book Your Stay";
}

<!-- Hero Section -->
<section class="pt-20 pb-12 bg-gradient-to-r from-amber-50 to-amber-100">
    <div class="container mx-auto px-4">
        <div class="text-center">
            <h1 class="text-5xl font-bold mb-4 font-serif text-amber-900">Book Your Stay</h1>
            <p class="text-xl text-amber-800 max-w-3xl mx-auto">
                Reserve your perfect room at Grand Hotel Petrich and experience luxury accommodation.
            </p>
        </div>
    </div>
</section>

<section class="py-16">
    <div class="container mx-auto px-4">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Booking Form -->
            <div class="lg:col-span-1">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold font-serif mb-6">Reservation Details</h2>

                    <form asp-area="Guest" asp-controller="Booking" asp-action="Create" method="post" class="space-y-4">
                        <div>
                            <label asp-for="CheckInDate" class="block text-sm font-medium mb-2">Check-in Date *</label>
                            <input asp-for="CheckInDate" class="form-input" type="date" />
                            <span asp-validation-for="CheckInDate" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label asp-for="CheckOutDate" class="block text-sm font-medium mb-2">Check-out Date *</label>
                            <input asp-for="CheckOutDate" class="form-input" type="date" />
                            <span asp-validation-for="CheckOutDate" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label asp-for="Guests" class="block text-sm font-medium mb-2">Number of Guests *</label>
                            <input asp-for="Guests" type="number" min="1" max="6" class="form-input" />
                            <span asp-validation-for="Guests" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label asp-for="RoomTypeId" class="block text-sm font-medium mb-2">Room Type</label>
                            <select asp-for="RoomTypeId" asp-items="Model.RoomTypes" class="form-input">
                                <option value="">Select a room type</option>
                            </select>
                            <span asp-validation-for="RoomTypeId" class="text-red-500 text-sm"></span>
                        </div>

                        <div>
                            <label asp-for="SpecialRequests" class="block text-sm font-medium mb-2">Special Requests</label>
                            <textarea asp-for="SpecialRequests" rows="3" class="form-input" placeholder="Optional notes..."></textarea>
                            <span asp-validation-for="SpecialRequests" class="text-red-500 text-sm"></span>
                        </div>

                        <button type="submit" class="w-full px-6 py-3 bg-amber-600 text-white rounded-md hover:bg-amber-700 font-medium">
                            Search Available Rooms
                        </button>
                    </form>
                </div>
            </div>

            <!-- Available Rooms -->
            <div class="lg:col-span-2">
                <h2 class="text-3xl font-bold mb-6 font-serif">Available Rooms</h2>

                @if (Model.AvailableRooms != null && Model.AvailableRooms.Any())
                {
                    foreach (var room in Model.AvailableRooms)
                    {
                        <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition-shadow cursor-pointer mb-4">
                            <div class="grid md:grid-cols-3 gap-6">
                                <div>
                                    <img src="@room.ImageUrl" alt="@room.Name" class="w-full h-32 object-cover rounded-lg" />
                                </div>
                                <div class="md:col-span-2">
                                    <div class="flex justify-between items-start mb-2">
                                        <h3 class="text-xl font-semibold">@room.Name</h3>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-amber-600">€@room.PricePerNight</div>
                                            <div class="text-sm text-gray-500">per night</div>
                                        </div>
                                    </div>

                                    <div class="flex flex-wrap gap-2 mb-3">
                                        @foreach (var feature in room.Features)
                                        {
                                            <span class="px-2 py-1 bg-gray-100 rounded-full text-xs">@feature</span>
                                        }
                                    </div>

                                    <form asp-area="Guest" asp-controller="Booking" asp-action="Confirm" method="post">
                                        <input type="hidden" name="RoomId" value="@room.Id" />
                                        <input type="hidden" name="CheckInDate" value="@Model.CheckInDate.ToString("yyyy-MM-dd")" />
                                        <input type="hidden" name="CheckOutDate" value="@Model.CheckOutDate.ToString("yyyy-MM-dd")" />
                                        <input type="hidden" name="Guests" value="@Model.Guests" />
                                        <input type="hidden" name="SpecialRequests" value="@Model.SpecialRequests" />
                                        <button type="submit" class="px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700">
                                            Select Room
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    }
                }
                else if (Model.CheckInDate != default && Model.CheckOutDate != default)
                {
                    <p class="text-gray-500 italic">No available rooms match your search criteria.</p>
                }
                else
                {
                    <p class="text-gray-400">Search for available rooms using the form on the left.</p>
                }
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
